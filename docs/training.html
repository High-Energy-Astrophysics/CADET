<!DOCTYPE html>
<html lang="en">
<head>
<title>CADET</title>
<link rel="icon" href="figures/CADET.png">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
<link rel="stylesheet" href="styles.css">

<header>
    <em>Cavity Detection Tool</em>  (CADET)
</header>

<a href="https://github.com/tomasplsek/CADET">
    <img src="figures/github.png" alt="github.com/tomasplsek/CADET" class="github_logo">
</a>

<img src="figures/CADET.png" class="cadet_logo">

<div class="sidenav">
<a id="menu" href="index.html">Overview</a>
<a style="color: rgb(20, 97, 179);font-weight: 600;" id="menu" href="training.html">Training</a>
<a id="menu" href="results.html">Results</a>
<a id="menu" href="usage.html">How to use</a>
<!-- <a id="menu" href="online.html">Web app</a> -->
</div>

<main>

<section>

<!-- <h1>Training of the CNN</h1> -->

<br class="shortbr">

<p>
    The convolutional neural network was trained on artificial images of simulated galaxies which were 
    produced by generating spheroidal <b>3D beta models</b>
    <a target="_blank" href="https://ui.adsabs.harvard.edu/abs/1978A%26A....70..677C/abstract">[Cavaliere1978]</a>
    into which we randomly inserted <b>ellipsoidal cavities</b>. The parameter ranges and 
    distributions used for generating models of galaxies and X-ray cavities were 
    estimated from the measurements of a <b>sample of 70 nearby galaxies</b> (for more info see 
    <a target="_blank" href="https://arxiv.org/abs/2304.05457">[Plšek2023]</a>). 
    Besides X-ray cavities, we added other features such as <b>bright rims</b> around X-ray cavities 
    and antisymmetric spiral perturbations resembling <b>gas sloshing</b> (see image below) to imitate the gas distribution of real galaxies. 
    The produced models were summed into 2D images a noised using <b>Poisson statistics</b> to resemble real <em>Chandra</em>-like images. 
    The corresponding labels were produced similarly by summing ellipsoidal cavity masks 
    into 2D images and binning them to contain either ones (inside the cavity) and zeros (outside of it).

    <br class="longbr">

    Elliptical β-models and ellipsoidal cavities were generated with the use of the 
    <a href="https://github.com/google/jax"><em><b>JAX</b></em></a> library (version 0.2.26).
    The training data was created `on the fly` during the training of the network: a mini-batch of images 
    was generated by the data generator function before each gradient update. Thanks to the <b>GPU</b> support 
    of the <em><b>JAX</b></em> library, training images were generated in a 
    vectorized way using the same GPU as was used for training of the network. This dramatically improved 
    the data generation time compared to generating the data using a CPU and also enabled additional 
    tweaking of the parameters of training images between individual training runs.
</p>

<br>

<img src="figures/artificial.png" title="Artificial images" style="width: 85%; margin: auto; display: block;">

<p class="figure_caption">
    <b>Figure 1:</b> Examples of artificially generated images with various features: <b>a)</b> single beta model 
    without cavities, <b>b)</b> beta model with cavities, <b>c)</b> beta model with cavities and type I rims, <b>d)</b> 
    beta model with cavities and type II rims, <b>e)</b> beta model with cavities and gas sloshing. Individual columns 
    show: the resulting noisy image, binary cavity mask, cavity rim pattern, and  sloshing pattern.
</p>  

<br class="shortbr">

</section>

<section>

<h2>Parameters of training images</h2>

<img src="figures/primary_cavities.png" title="Primary cavities" style="width: 95%; margin: auto; display: block;">
<img src="figures/secondary_cavities.png" title="Secondary cavities" style="width: 95%; margin: auto; display: block;">

<img src="figures/single_alpha.png" title="Single beta models" style="width: 95%; margin: auto; display: block;">
<img src="figures/double_alpha_1.png" title="Double beta models (primary)" style="width: 95%; margin: auto; display: block;">
<img src="figures/double_alpha_2.png" title="Double beta models (secondary)" style="width: 65%; margin: auto; display: block;">

<br class="longbr">

</section>

</main>

<footer>
    &#169; <a target="_blank" style="color:white;" href="https://www.physics.muni.cz/~plsek/index-EN.html">Tomáš Plšek</a> <span style="font-weight: bolder;">&middot;</span> 2023
</footer>    

</body>

</html>